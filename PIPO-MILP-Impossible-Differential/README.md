# PIPO-MILP-Impossible-Differential
MILP Based Impossible Differential Characteristics Search for Lightweight Block Cipher PIPO-64/128 \
**_Linear inequalities required for MILP problem are generated using MILES (https://github.com/tarunyadav/MILES)._**
## Source Code 
### There are four files in this source code.
* _MILP_Outer.py_
* _LinearInequalities_Outer.txt_ (Generated from MILES)
* _Outer_4_Impossible_Template.lp_
* _Outer_5_Impossible_Template.lp_


## MILP model to search impossible differential characteristics
* We have seen that _MILP_Outer.py_ (in parent folder) is used to minimize number of active S-boxes in PIPO. It uses _LinearInequalities_Outer.txt_ to write linear inequalities of the S-box. We have made some changes in _MILP_Outer.py_ such that instead of minimizing number of active S-boxes, it searches an impossible differential characteristics. The idea is to fix the input as well as output differences and then check for feasiblity of the model. If the model is infeasible and the solution count is zero then it is a impossible differential characteristic. In the source code, we have taken one bit active in the input as well as output difference. The _MILP_Outer.py_ checks one such difference and if the model is feasible it checks for another difference. Whenever an infeasible model is found with solution count zero, it stop and prints the input as well output differences in decimal and binary. 
* There are two arugment for _MILP_Outer.py_. First argument defines number of rounds and second argument define the minimum number of active S-boxes in all rounds. We have used the value of second arugment as 1.
* The template files are provided for 4-round and 5-round impossible differential characteristic search. Use of template makes the program faster. Instead of writing the complete MILP model every time, we just need to change the value of variables, corresponding to the input and output difference, in the template. Template files can be easily generated by uncommenting line 211 and 212 in _MILP_Outer.py_.
* The impossible differential characteristics for 4 rounds is searched using following command:\
```MILP_Outer.py 4 1```
* The output is in the following format:
``` 
...
Iteration No. - 1_4
...
...
...
Solution count 0

Model is infeasible
...
[1, 16]
['0000000000000000000000000000000000000000000000000000000000000001', '0000000000000000000000000000000000000000000000000000000000010000']
```

[a,b] => a is input difference and b is output difference of the impossible differential characteristic.
